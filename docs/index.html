<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Implementation of a 'MS Dynamics CRM' Client • rdynamicscrm</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="An Implementation of a 'MS Dynamics CRM' Client">
<meta property="og:description" content="An implementation of a 'MS Dynamics CRM' client. Microsoft Dynamics 
    CRM is a customer relationship management (CRM) software package developed by 
    Microsoft &lt;https://dynamics.microsoft.com/en-us/&gt;. This package is an articulation 
    of SOAP API calls to a CRM Online and On Premise IFD environment. For more details 
    please see the 'MS Dynamics CRM' documentation &lt;https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/use-microsoft-dynamics-365-organization-service&gt; 
    and this package's website &lt;https://stevenmmortimer.github.io/rdynamicscrm/&gt; 
    for more information, documentation, and examples.">
<meta property="og:image" content="https://stevenmmortimer.github.io/rdynamicscrm/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98603021-2', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">rdynamicscrm</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/getting-started.html">Getting Started</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/StevenMMortimer/rdynamicscrm">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    

<p><br><img src="reference/figures/rdynamicscrm.png" width="120px" align="right"></p>
<p><strong>rdynamicscrm</strong> is an R package that creates a client to connect to MS Dynamics CRM. Package features include:</p>
<ul>
<li>An auto-refreshing authentication method (<code><a href="reference/dyn_auth.html">dyn_auth()</a></code>)</li>
<li>CRUD (Create, Retrieve, Update, Delete) methods for records, such as:
<ul>
<li>
<code><a href="reference/dyn_create.html">dyn_create()</a></code>, <code>dyn_retreive()</code>, <code><a href="reference/dyn_update.html">dyn_update()</a></code>, <code><a href="reference/dyn_delete.html">dyn_delete()</a></code>
</li>
</ul>
</li>
<li>Query records using <code><a href="reference/dyn_query.html">dyn_query()</a></code>
</li>
<li>Basic utility calls (<code><a href="reference/dyn_whoami.html">dyn_whoami()</a></code>)</li>
</ul>
<div id="table-of-contents" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of Contents</h2>
<ul>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#usage">Usage</a>
<ul>
<li><a href="#authenticate">Authenticate</a></li>
<li><a href="#create">Create</a></li>
<li><a href="#query">Query</a></li>
<li><a href="#update">Update</a></li>
<li><a href="#delete">Delete</a></li>
</ul>
</li>
<li><a href="#future">Future</a></li>
<li><a href="#credits">Credits</a></li>
<li><a href="#more-information">More Information</a></li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># this package is not yet available on CRAN </span>
<span class="co"># install the latest version available on GitHub using the devtools package</span>

<span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"StevenMMortimer/rdynamicscrm"</span>)</code></pre></div>
<p>If you encounter a clear bug, please file a minimal reproducible example on <a href="https://github.com/StevenMMortimer/rdynamicscrm/issues">GitHub</a>.</p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div id="authenticate" class="section level3">
<h3 class="hasAnchor">
<a href="#authenticate" class="anchor"></a>Authenticate</h3>
<p>First, load the <strong>rdynamicscrm</strong> package and authenticate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rdynamicscrm)

<span class="kw"><a href="reference/dyn_auth.html">dyn_auth</a></span>(<span class="dt">url =</span> <span class="st">"https://test.ztcrm.org/"</span>,
         <span class="dt">username =</span> <span class="st">"test@live.com"</span>, 
         <span class="dt">password =</span> <span class="st">"{PASSWORD_HERE}"</span>)</code></pre></div>
<p>The <code><a href="reference/dyn_auth.html">dyn_auth()</a></code> function will obtain a cipher and secret key that will be embedded in the header of each SOAP API call to securely access the CRM instance. After obtaining these authentication credentials, you can check your connectivity by looking at the information returned about the current user. It should be information about you!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># pull down information of person logged in</span>
<span class="co"># it's a simple easy call to get started </span>
<span class="co"># and confirm a connection to the APIs</span>
me &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_whoami.html">dyn_whoami</a></span>()
my_info &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_retrieve.html">dyn_retrieve</a></span>(me<span class="op">$</span>UserId, <span class="dt">entity_name=</span><span class="st">"systemuser"</span>, 
                        <span class="dt">attributes=</span><span class="kw">c</span>(<span class="st">"fullname"</span>, <span class="st">"isdisabled"</span>))
<span class="co">#sprintf("Name: %s", my_info$fullname)</span>
<span class="kw">sprintf</span>(<span class="st">"Disabled?: %s"</span>, my_info<span class="op">$</span>isdisabled)
<span class="co">#&gt; [1] "Disabled?: false"</span></code></pre></div>
</div>
<div id="create" class="section level3">
<h3 class="hasAnchor">
<a href="#create" class="anchor"></a>Create</h3>
<p>MS Dynamics CRM has entities and those entities contain records. One default entity is the “contact” entity. This example shows how to create two records in the contact entity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">2</span>
new_contacts &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">firstname =</span> <span class="kw">rep</span>(<span class="st">"Test"</span>, n),
                       <span class="dt">lastname =</span> <span class="kw">paste0</span>(<span class="st">"Contact-Create-"</span>, <span class="dv">1</span><span class="op">:</span>n))
created_records &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_create.html">dyn_create</a></span>(new_contacts, <span class="dt">entity_name=</span><span class="st">"contact"</span>)
created_records
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   id                                   success error_msg</span>
<span class="co">#&gt;   &lt;chr&gt;                                &lt;lgl&gt;   &lt;chr&gt;    </span>
<span class="co">#&gt; 1 9bb48ed7-f39e-e811-80e9-001dd8b75c2b TRUE    &lt;NA&gt;     </span>
<span class="co">#&gt; 2 9eb48ed7-f39e-e811-80e9-001dd8b75c2b TRUE    &lt;NA&gt;</span></code></pre></div>
</div>
<div id="query" class="section level3">
<h3 class="hasAnchor">
<a href="#query" class="anchor"></a>Query</h3>
<p>MS Dynamics CRM has proprietary form of SQL called FetchXML. FetchXML is a powerful tool that allows you to return the attributes of records on almost any entity in MS Dynamics CRM including accounts, contacts, custom entities and more!</p>
<p>For simple “SELECT” queries you only need to specify the entity and the fields.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">queried_records &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_query.html">dyn_query</a></span>(<span class="dt">entity_name =</span> <span class="st">"contact"</span>,
                             <span class="dt">attributes =</span> <span class="kw">c</span>(<span class="st">"modifiedon"</span>, <span class="st">"donotbulkemail"</span>), <span class="dt">top=</span><span class="dv">3</span>)
queried_records
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   contactid                            donotbulkemail modifiedon         </span>
<span class="co">#&gt;   &lt;chr&gt;                                &lt;chr&gt;          &lt;dttm&gt;             </span>
<span class="co">#&gt; 1 de9c2055-e833-e211-8139-000c29e211a0 false          2012-11-21 14:33:17</span>
<span class="co">#&gt; 2 e29c2055-e833-e211-8139-000c29e211a0 false          2012-11-21 14:33:17</span>
<span class="co">#&gt; 3 e49c2055-e833-e211-8139-000c29e211a0 false          2012-11-21 14:33:17</span></code></pre></div>
<p>Below is an example where we grab the two contact records we just created using FetchXML to specifically target those records.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_fetchxml &lt;-<span class="st"> '&lt;fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false"&gt;</span>
<span class="st">                  &lt;entity name="contact" &gt;</span>
<span class="st">                    &lt;attribute name="firstname" /&gt;</span>
<span class="st">                    &lt;attribute name="lastname" /&gt;</span>
<span class="st">                    &lt;filter type="or"&gt;</span>
<span class="st">                      &lt;condition attribute="lastname" operator="eq" value="Contact-Create-1" /&gt;</span>
<span class="st">                      &lt;condition attribute="lastname" operator="eq" value="Contact-Create-2" /&gt;</span>
<span class="st">                    &lt;/filter&gt;</span>
<span class="st">                  &lt;/entity&gt;</span>
<span class="st">                &lt;/fetch&gt;'</span>  
queried_records &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_query.html">dyn_query</a></span>(<span class="dt">fetchxml=</span>my_fetchxml)
queried_records
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   contactid                            firstname lastname        </span>
<span class="co">#&gt;   &lt;chr&gt;                                &lt;chr&gt;     &lt;chr&gt;           </span>
<span class="co">#&gt; 1 9bb48ed7-f39e-e811-80e9-001dd8b75c2b Test      Contact-Create-1</span>
<span class="co">#&gt; 2 9eb48ed7-f39e-e811-80e9-001dd8b75c2b Test      Contact-Create-2</span></code></pre></div>
</div>
<div id="update" class="section level3">
<h3 class="hasAnchor">
<a href="#update" class="anchor"></a>Update</h3>
<p>After creating records you can update them using <code><a href="reference/dyn_update.html">dyn_update()</a></code>. Updating a record requires you to pass the MS Dynamics CRM <code>Id</code> of the record. MS Dynamics CRM creates a GUID (globally unique identifier) on each record and uses that to know which record to attach the update information you provide. Simply include a field or column in your update dataset called “Id” and the information will be matched. Here is an example where we update each of the records we created earlier with a new first name called “TestTest”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Update some of those records</span>
queried_records &lt;-<span class="st"> </span>queried_records <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">firstname =</span> <span class="st">"TestTest"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="dt">id=</span>contactid)

updated_records &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_update.html">dyn_update</a></span>(queried_records, <span class="dt">entity_name=</span><span class="st">"contact"</span>)
updated_records
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   id                                   success error_msg</span>
<span class="co">#&gt;   &lt;chr&gt;                                &lt;lgl&gt;   &lt;chr&gt;    </span>
<span class="co">#&gt; 1 9bb48ed7-f39e-e811-80e9-001dd8b75c2b TRUE    &lt;NA&gt;     </span>
<span class="co">#&gt; 2 9eb48ed7-f39e-e811-80e9-001dd8b75c2b TRUE    &lt;NA&gt;</span></code></pre></div>
</div>
<div id="delete" class="section level3">
<h3 class="hasAnchor">
<a href="#delete" class="anchor"></a>Delete</h3>
<p>Records can easily be deleted individually or in bulk by passing a vector of IDs to the <code><a href="reference/dyn_delete.html">dyn_delete()</a></code> function. Here we will delete the two records that we created in this example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ids_to_delete &lt;-<span class="st"> </span>updated_records<span class="op">$</span>id
deleted_records &lt;-<span class="st"> </span><span class="kw"><a href="reference/dyn_delete.html">dyn_delete</a></span>(ids_to_delete, <span class="dt">entity_name=</span><span class="st">"contact"</span>)
deleted_records
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;   id                                   success error_msg</span>
<span class="co">#&gt;   &lt;chr&gt;                                &lt;lgl&gt;   &lt;chr&gt;    </span>
<span class="co">#&gt; 1 9bb48ed7-f39e-e811-80e9-001dd8b75c2b TRUE    &lt;NA&gt;     </span>
<span class="co">#&gt; 2 9eb48ed7-f39e-e811-80e9-001dd8b75c2b TRUE    &lt;NA&gt;</span></code></pre></div>
</div>
</div>
<div id="future" class="section level2">
<h2 class="hasAnchor">
<a href="#future" class="anchor"></a>Future</h2>
<p>Support for:</p>
<ul>
<li>Online environments (not just On-Premise IFD environments)</li>
<li>Upsert</li>
<li>Related Entities</li>
</ul>
</div>
<div id="credits" class="section level2">
<h2 class="hasAnchor">
<a href="#credits" class="anchor"></a>Credits</h2>
<p>This application has derived inspiration from other open source software components. The format of the XML in SOAP calls was created by following mimicking implementations in <a href="https://github.com/jlattimer/CRMSoapAuthJava">Java</a> by Jason Lattimer and <a href="https://github.com/veeloinc/python-dynamics">Python</a> by Veelo, Inc. In addition, inspiration was drawn from examples created by Jamie Miley that are available on his <a href="http://mileyja.blogspot.com/p/microsoft-dynamics-crm-2011-sdk-example.html">blog</a>. We acknowledge and are grateful to these developers for their contributions to open source.</p>
</div>
<div id="more-information" class="section level2">
<h2 class="hasAnchor">
<a href="#more-information" class="anchor"></a>More Information</h2>
<p>Microsoft provides support with a C# client library. Unfortunately R is not a supported language. However, most all operations supported by Dynamics CRM can be made available via this package. This package makes requests best formatted to match what the API requires as input. This articulation is not perfect and continued progress will be made to add and improve functionality. For details on formatting, attributes, and methods please refer to <a href="https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/use-microsoft-dynamics-365-organization-service">Microsoft’s documentation</a> as they are explained better there.</p>
<p><a href="#">Top</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/StevenMMortimer/rdynamicscrm">https://​github.com/​StevenMMortimer/​rdynamicscrm</a>
</li>
<li>Report a bug at <br><a href="https://github.com/StevenMMortimer/rdynamicscrm/issues">https://​github.com/​StevenMMortimer/​rdynamicscrm/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Steven M. Mortimer <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/StevenMMortimer/rdynamicscrm"><img src="https://travis-ci.org/StevenMMortimer/rdynamicscrm.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/StevenMMortimer/rdynamicscrm"><img src="https://ci.appveyor.com/api/projects/status/github/StevenMMortimer/rdynamicscrm?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/gh/StevenMMortimer/rdynamicscrm?branch=master"><img src="https://codecov.io/gh/StevenMMortimer/rdynamicscrm/branch/master/graph/badge.svg" alt="Coverage Status"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Steven M. Mortimer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
